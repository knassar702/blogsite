[{"ref":"https://blog.knas.me/blog/gitea_dos/","title":"With a single request, you can kill any Gitea server","section":"blog","tags":["cybersecurity","bugbounty","dos"],"date":"2023.01.25","body":"Hey :smiley:\nin this blog I\u0026rsquo;m going to tell you how I was able to kill/dos any Gitea server I discovered this bug in Gitea version 1.14.2 in 2021\nwhich was fixed in 1.14.3 by the Gitea team Please note that I wasn\u0026rsquo;t targeting Gitea at all, I was doing some bug bounty hunting on a private target That target\u0026rsquo;s staging-dev.target.com has gitea on it\nand I thought, \u0026ldquo;Okay, I think there\u0026rsquo;s CVES for that product\u0026rdquo; and yeah I found some but Unfortunately, the POC isn\u0026rsquo;t included in the CVE report (only the PR on github)\nso I decided to play around and see if there\u0026rsquo;s any private keys in the repos on this gitea server (I didn\u0026rsquo;t find any)\nand my mind give me an idea, what If I created an account on this server? I thought I could find out more because maybe there\u0026rsquo;s an option that lets the user make the repositories private for people with an account on Gitea\nAfter creating my account, I didn\u0026rsquo;t see any difference so the last option I have is to send emojis to Gitea\u0026rsquo;s issues page for trolling or joking\nThen I opened Zaproxy and sent many of these emojis to the issues body API in one request Afterwards, I noticed that subdomain response time is going up I got a 500 error, and boom, the server wasn\u0026rsquo;t responding when I try to visit the gitea issue that I opened\nWhen I reported this bug to my target\u0026rsquo;s security team, the response was too fast, saying \u0026ldquo;Sorry, this is not a part of our products. Could you please forward this report to the Gitea security team\u0026rdquo; But what\u0026rsquo;s good is they provide me with more info to make a good report for the Gitea security team like logs, screenshots of CPU usage, etc. When someone visits my gitea issue containing the emojis, the CPU usage gets high. That\u0026rsquo;s because there\u0026rsquo;s too much text formatting/processing happening in the back-end for the comment After I reported the bug to Gitea, they asked me some questions about the environment and if I could reproduce it at the last version (it\u0026rsquo;s on try.gitea.io)\nI\u0026rsquo;ve included it in the report\nGitea version : 1.14.2 Git version: 2.32.0 Operating system: Linux Database: MySQL Can you reproduce the bug at https://try.gitea.io: Yes (https://try.gitea.io/dtestman/test/issues/1) They respond after 2 days with validating the bug and a PR, and my name is on the release page for my next release :smile:\nhere\u0026rsquo;s the release page: https://blog.gitea.io/2021/06/gitea-1.14.3-is-released/\nand the fix PR: https://github.com/go-gitea/gitea/pull/16185\nSee you\n"}]