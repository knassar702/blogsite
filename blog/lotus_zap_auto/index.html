<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to optimize Zaproxy as an authorized crawler for Lotus | Khaled Nassar blog</title><meta name=keywords content><meta name=description content="TLDR > Optimize Zapoxy as an authorized crawler for Lotus using its scripting and automation framework
List of Content Introduction What&rsquo;s Zaproxy Scripting Works Exporting customs sitemap in JSON output Using the Output with Lotus Introduction Zaproxy is a powerful security automation tool with numerous hidden features, in this blog post we will explore its capabilities for authentication, crawling, scoping, and utilizing the results in another tool Specifically, we will focus on using Lotus, a tool that supports custom sitemap JSON format, to efficiently scan full requests"><meta name=author content="Khaled Nassar"><link rel=canonical href=https://blog.knas.me/blog/lotus_zap_auto/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.knas.me/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://blog.knas.me/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://blog.knas.me/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://blog.knas.me/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://blog.knas.me/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="How to optimize Zaproxy as an authorized crawler for Lotus"><meta property="og:description" content="TLDR > Optimize Zapoxy as an authorized crawler for Lotus using its scripting and automation framework
List of Content Introduction What&rsquo;s Zaproxy Scripting Works Exporting customs sitemap in JSON output Using the Output with Lotus Introduction Zaproxy is a powerful security automation tool with numerous hidden features, in this blog post we will explore its capabilities for authentication, crawling, scoping, and utilizing the results in another tool Specifically, we will focus on using Lotus, a tool that supports custom sitemap JSON format, to efficiently scan full requests"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.knas.me/blog/lotus_zap_auto/"><meta property="og:image" content="https://blog.knas.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-02-06T21:52:54+02:00"><meta property="article:modified_time" content="2023-02-06T21:52:54+02:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.knas.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="How to optimize Zaproxy as an authorized crawler for Lotus"><meta name=twitter:description content="TLDR > Optimize Zapoxy as an authorized crawler for Lotus using its scripting and automation framework
List of Content Introduction What&rsquo;s Zaproxy Scripting Works Exporting customs sitemap in JSON output Using the Output with Lotus Introduction Zaproxy is a powerful security automation tool with numerous hidden features, in this blog post we will explore its capabilities for authentication, crawling, scoping, and utilizing the results in another tool Specifically, we will focus on using Lotus, a tool that supports custom sitemap JSON format, to efficiently scan full requests"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"https://blog.knas.me/blog/"},{"@type":"ListItem","position":2,"name":"How to optimize Zaproxy as an authorized crawler for Lotus","item":"https://blog.knas.me/blog/lotus_zap_auto/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to optimize Zaproxy as an authorized crawler for Lotus","name":"How to optimize Zaproxy as an authorized crawler for Lotus","description":"TLDR \u0026gt; Optimize Zapoxy as an authorized crawler for Lotus using its scripting and automation framework\nList of Content Introduction What\u0026rsquo;s Zaproxy Scripting Works Exporting customs sitemap in JSON output Using the Output with Lotus Introduction Zaproxy is a powerful security automation tool with numerous hidden features, in this blog post we will explore its capabilities for authentication, crawling, scoping, and utilizing the results in another tool Specifically, we will focus on using Lotus, a tool that supports custom sitemap JSON format, to efficiently scan full requests","keywords":[],"articleBody":"TLDR \u003e Optimize Zapoxy as an authorized crawler for Lotus using its scripting and automation framework\nList of Content Introduction What’s Zaproxy Scripting Works Exporting customs sitemap in JSON output Using the Output with Lotus Introduction Zaproxy is a powerful security automation tool with numerous hidden features, in this blog post we will explore its capabilities for authentication, crawling, scoping, and utilizing the results in another tool Specifically, we will focus on using Lotus, a tool that supports custom sitemap JSON format, to efficiently scan full requests\nWhat’s Zaproxy Scripting Zaproxy Scripting empowers users to execute custom scripts within Zaproxy, These scripts provide the ability to extend Zaproxy’s functionality according to specific requirements, users can automate tasks, employ advanced scanning techniques, manipulate requests and responses, implement custom logic, and gain control over the HTTP sender, authentication, the browser, and more\nThis flexibility allows users to write scripts that can be executed at any time to control different aspects of their security automation workflow In this blog, we will utilize the standalone script type to export the sitemap in our custom JSON schema\nBut it’s important to note that standalone scripts require manual execution by the user since they lack any triggers, unlike HTTP scripts which can be automatically triggered after sending an HTTP request As a result of this, we will utilize a Zaproxy plugin called Automation which enables the automation of various Zaproxy components through a straightforward YAML file.\nExporting customs sitemap in JSON output To export the JSON output, we will modify a standalone script called Traverse sites tree.js\" from the Zaproxy community scripts repository, we will rewrite it in Python and utilize modules such as json and regex to save the output in JSON format\n\"\"\" This script utilizes the Automation Framework to retrieve Spider Results and pass the requests to another tool. By: Khaled Nassar (aka nas.k) EmaiL knassar702@gmail.com Site: (blog.knas.me) \"\"\" from org.parosproxy.paros.model import Model from os.path import expanduser import json import re # Convert string headers to dictionary def extract_headers(headers): \"\"\" \u003e\u003e\u003e extract_headers('User-agent: YES') {'User-agent':'YES'} \u003e\u003e\u003e extract_headers('User-agent: YES\\nHacker: 3') {'User-agent':'YES','Hacker':'3'} \"\"\" headers = headers.replace(\"\\\\n\", \"\\n\") sorted_headers = {} matches = re.findall(r\"(.*):\\s(.*)\", headers) for match in matches: header = match[0] value = match[1] if value[-1] == \",\": value = value[:-1] sorted_headers[header] = value.split()[0] return sorted_headers def list_children(node, level): global reqs for j in range(0, node.getChildCount()): current_req = {} msg = node.getChildAt(j).getHistoryReference().getHttpMessage() if msg.isInScope() == False: continue req_headers = msg.getRequestHeader().toString() current_req[\"method\"] = req_headers.split(\" \")[0] current_req[\"url\"] = req_headers.split(\" \")[1] current_req[\"headers\"] = extract_headers(req_headers) current_req[\"body\"] = msg.getRequestBody().toString() reqs.append(current_req) list_children(node.getChildAt(j), level + 1) reqs = [] root = Model.getSingleton().getSession().getSiteTree().getRoot() list_children(root, 0) with open(\"{}/reqs.json\".format(expanduser(\"~\")), \"w\") as f: f.write(json.dumps(reqs)) To achieve the desired outcome, follow these steps:\nCreate a new script in Zaproxy with the script type set to standalone. Copy and paste the provided code into the script editor. Send an HTTP request through Zaproxy. Run the script by clicking on the “Run” button. After the script execution, you will find the JSON output saved at /home/{USER}/reqs.json. Note: Replace {USER} in the file path with the appropriate user directory on your system\nZaproxy Automation Framework As mentioned earlier in the blog, you have the ability to control various components of Zaproxy using a simple YAML file. To access this feature, follow the steps below:\nOpen Zaproxy and click on the “New” tab. Select “Automation” from the options after installing it from the marketplace. Choose the desired components, such as Spider and script components. In the “Scripts” tab, select the JSON output script we discussed earlier. Modify the scope according to your requirements by adjusting the settings. Click on the “Run” button to execute the automation process. Make sure to refer to the screenshots for a visual reference on how to access the Zaproxy Automation Framework and configure the scope.\nAfter configuring the automation settings, click on the “Run” button and wait for the process to finish. Once completed, you can find the sitemap of your specified scope at /home/{USER}/reqs.json, where {USER} represents the appropriate user directory on your system.\nUsing the Output with Lotus you can use the SCAN_TYPE number 0\nNote: this script is not offical, just a simple example to scan url,body parameters in multi-threading\n-- xss.lua SCAN_TYPE = 0 PAYLOADS = {\"\\\"\u003e\",\"\\\"\u003e\"} function scanner(param_type, payload) local reqs = full_req:set(param_type, payload) for _, req in pairs(reqs) do local resp = req:send(req,http) local body = resp[\"body\"] if str_contains(body,payload) == true then Reports:add { name = \"Reflected XSS\", url = resp.url, risk = \"mideum\", } end end end function main() http:merge_headers(true) LuaThreader:iter_scan({full_req:body(), full_req:url()}, PAYLOADS, scanner, 10) end $ cat /home/user/reqs.txt | lotus scan xss.lua [knas@Home ~]$ cat reqs.json | ./lotus scan xss.lua [INFO] Number of URLs: 2 [INFO] Number of hosts: 0 [INFO] Number of HTTP MSGS: 2 [INFO] Number of paths: 2 [INFO] Number of custom entries: 0 { [#] name: \"Reflected XSS\" [#] risk: \"mideum\" [#] url: \"http://testphp.vulnweb.com/listproducts.php?cat=1%22%3E%3Cimg+src%3Dx+onerror%3Dalert%28%29%3E\" } { [#] name: \"Reflected XSS\" [#] risk: \"mideum\" [#] url: \"http://testphp.vulnweb.com/listproducts.php?cat=1%22%3E%3Csvg%2Fonload%3Dalert%28%29%3E\" } It’s important to note that Lotus can be used with Zaproxy in various scan types, including host scan, passive scan, and URL scan, not limited to just full scans This flexibility allows you to leverage Lotus’s capabilities across different scanning scenarios\nIn conclusion, by harnessing the power of Zaproxy’s authorized crawling capabilities, scripting, and automation framework, combined with Lotus’s custom sitemap JSON format, you can optimize your security testing and automation efforts Whether it’s authenticating, crawling, scoping, or integrating the results with other tools, this comprehensive approach enables you to enhance your security posture effectively\nRemember to experiment, explore, and stay updated with the latest features and developments in both Zaproxy and Lotus to make the most of their combined potential in securing your applications and systems\n","wordCount":"951","inLanguage":"en","datePublished":"2023-02-06T21:52:54+02:00","dateModified":"2023-02-06T21:52:54+02:00","author":{"@type":"Person","name":"Khaled Nassar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.knas.me/blog/lotus_zap_auto/"},"publisher":{"@type":"Organization","name":"Khaled Nassar blog","logo":{"@type":"ImageObject","url":"https://blog.knas.me/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.knas.me/ accesskey=h title="Home (Alt + H)"><img src=https://blog.knas.me/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://blog.knas.me/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://blog.knas.me/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.knas.me/>Home</a>&nbsp;»&nbsp;<a href=https://blog.knas.me/blog/>Blogs</a></div><h1 class=post-title>How to optimize Zaproxy as an authorized crawler for Lotus</h1><div class=post-meta><span title='2023-02-06 21:52:54 +0200 +0200'>February 6, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;951 words&nbsp;·&nbsp;Khaled Nassar&nbsp;|&nbsp;<a href=https://github.com/knassar702/knas.me/tree/master//blog/lotus_zap_auto.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p><strong>TLDR</strong> > Optimize Zapoxy as an authorized crawler for Lotus using its scripting and automation framework</p><h1 id=list-of-content>List of Content<a hidden class=anchor aria-hidden=true href=#list-of-content>#</a></h1><ul><li>Introduction</li><li>What&rsquo;s Zaproxy Scripting Works</li><li>Exporting customs sitemap in JSON output</li><li>Using the Output with Lotus</li></ul><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>Zaproxy is a powerful security automation tool with numerous hidden features, in this blog post we will explore its capabilities for authentication, crawling, scoping, and utilizing the results in another tool
Specifically, we will focus on using <a href=https://github.com/bugBlocker/lotus>Lotus</a>, a tool that supports custom sitemap JSON format, to efficiently scan full requests</p><h2 id=whats-zaproxy-scripting>What&rsquo;s Zaproxy Scripting<a hidden class=anchor aria-hidden=true href=#whats-zaproxy-scripting>#</a></h2><p>Zaproxy Scripting empowers users to execute custom scripts within Zaproxy,
These scripts provide the ability to extend Zaproxy&rsquo;s functionality according to specific requirements, users can automate tasks, employ advanced scanning techniques, manipulate requests and responses, implement custom logic, and gain control over the HTTP sender, authentication, the browser, and more</p><p>This flexibility allows users to write scripts that can be executed at any time to control different aspects of their security automation workflow
In this blog, we will utilize the <code>standalone</code> script type to export the sitemap in our custom JSON schema</p><p>But it&rsquo;s important to note that standalone scripts require manual execution by the user since they lack any triggers, unlike HTTP scripts which can be automatically triggered after sending an HTTP request
As a result of this, we will utilize a Zaproxy plugin called <code>Automation</code> which enables the automation of various Zaproxy components through a straightforward YAML file.</p><h2 id=exporting-customs-sitemap-in-json-output>Exporting customs sitemap in JSON output<a hidden class=anchor aria-hidden=true href=#exporting-customs-sitemap-in-json-output>#</a></h2><p>To export the JSON output, we will modify a standalone script called <a href=https://github.com/zaproxy/community-scripts/blob/main/standalone/Traverse%20sites%20tree.js>Traverse sites tree.js"</a> from the Zaproxy community scripts repository, we will rewrite it in Python and utilize modules such as json and regex to save the output in JSON format</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>This script utilizes the Automation Framework to retrieve Spider Results and pass the requests to another tool.
</span></span></span><span class=line><span class=cl><span class=s2>By: Khaled Nassar (aka nas.k) 
</span></span></span><span class=line><span class=cl><span class=s2>EmaiL knassar702@gmail.com 
</span></span></span><span class=line><span class=cl><span class=s2>Site: (blog.knas.me)
</span></span></span><span class=line><span class=cl><span class=s2>&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>org.parosproxy.paros.model</span> <span class=kn>import</span> <span class=n>Model</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os.path</span> <span class=kn>import</span> <span class=n>expanduser</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Convert string headers to dictionary</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>extract_headers</span><span class=p>(</span><span class=n>headers</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    &gt;&gt;&gt; extract_headers(&#39;User-agent: YES&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>    {&#39;User-agent&#39;:&#39;YES&#39;}
</span></span></span><span class=line><span class=cl><span class=s2>    &gt;&gt;&gt; extract_headers(&#39;User-agent: YES</span><span class=se>\n</span><span class=s2>Hacker: 3&#39;)
</span></span></span><span class=line><span class=cl><span class=s2>    {&#39;User-agent&#39;:&#39;YES&#39;,&#39;Hacker&#39;:&#39;3&#39;}
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>headers</span> <span class=o>=</span> <span class=n>headers</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>n&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>sorted_headers</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>matches</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s2>&#34;(.*):\s(.*)&#34;</span><span class=p>,</span> <span class=n>headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>match</span> <span class=ow>in</span> <span class=n>matches</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>header</span> <span class=o>=</span> <span class=n>match</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>value</span> <span class=o>=</span> <span class=n>match</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>value</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;,&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>value</span> <span class=o>=</span> <span class=n>value</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>sorted_headers</span><span class=p>[</span><span class=n>header</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span><span class=o>.</span><span class=n>split</span><span class=p>()[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>sorted_headers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>list_children</span><span class=p>(</span><span class=n>node</span><span class=p>,</span> <span class=n>level</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>global</span> <span class=n>reqs</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>node</span><span class=o>.</span><span class=n>getChildCount</span><span class=p>()):</span>
</span></span><span class=line><span class=cl>        <span class=n>current_req</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=n>msg</span> <span class=o>=</span> <span class=n>node</span><span class=o>.</span><span class=n>getChildAt</span><span class=p>(</span><span class=n>j</span><span class=p>)</span><span class=o>.</span><span class=n>getHistoryReference</span><span class=p>()</span><span class=o>.</span><span class=n>getHttpMessage</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>msg</span><span class=o>.</span><span class=n>isInScope</span><span class=p>()</span> <span class=o>==</span> <span class=kc>False</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=n>req_headers</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>getRequestHeader</span><span class=p>()</span><span class=o>.</span><span class=n>toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>current_req</span><span class=p>[</span><span class=s2>&#34;method&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>req_headers</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_req</span><span class=p>[</span><span class=s2>&#34;url&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>req_headers</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&#34; &#34;</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>current_req</span><span class=p>[</span><span class=s2>&#34;headers&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>extract_headers</span><span class=p>(</span><span class=n>req_headers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>current_req</span><span class=p>[</span><span class=s2>&#34;body&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>getRequestBody</span><span class=p>()</span><span class=o>.</span><span class=n>toString</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>reqs</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>current_req</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>list_children</span><span class=p>(</span><span class=n>node</span><span class=o>.</span><span class=n>getChildAt</span><span class=p>(</span><span class=n>j</span><span class=p>),</span> <span class=n>level</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>reqs</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>root</span> <span class=o>=</span> <span class=n>Model</span><span class=o>.</span><span class=n>getSingleton</span><span class=p>()</span><span class=o>.</span><span class=n>getSession</span><span class=p>()</span><span class=o>.</span><span class=n>getSiteTree</span><span class=p>()</span><span class=o>.</span><span class=n>getRoot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>list_children</span><span class=p>(</span><span class=n>root</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;</span><span class=si>{}</span><span class=s2>/reqs.json&#34;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>expanduser</span><span class=p>(</span><span class=s2>&#34;~&#34;</span><span class=p>)),</span> <span class=s2>&#34;w&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>reqs</span><span class=p>))</span>
</span></span></code></pre></div><p>To achieve the desired outcome, follow these steps:</p><ul><li>Create a new script in Zaproxy with the script type set to <code>standalone</code>.</li><li>Copy and paste the provided code into the script editor.</li><li>Send an HTTP request through Zaproxy.</li><li>Run the script by clicking on the &ldquo;Run&rdquo; button.</li><li>After the script execution, you will find the JSON output saved at <code>/home/{USER}/reqs.json</code>.</li></ul><blockquote><p>Note: Replace {USER} in the file path with the appropriate user directory on your system</p></blockquote><h2 id=zaproxy-automation-framework>Zaproxy Automation Framework<a hidden class=anchor aria-hidden=true href=#zaproxy-automation-framework>#</a></h2><p>As mentioned earlier in the blog, you have the ability to control various components of Zaproxy using a simple YAML file. To access this feature, follow the steps below:</p><ul><li>Open Zaproxy and click on the &ldquo;New&rdquo; tab.</li><li>Select &ldquo;Automation&rdquo; from the options after installing it from the marketplace.</li><li>Choose the desired components, such as Spider and script components.</li><li>In the &ldquo;Scripts&rdquo; tab, select the JSON output script we discussed earlier.</li><li>Modify the scope according to your requirements by adjusting the settings.</li><li>Click on the &ldquo;Run&rdquo; button to execute the automation process.</li></ul><p><img loading=lazy src=/images/zap_automation.png alt=zap_automation></p><p>Make sure to refer to the screenshots for a visual reference on how to access the Zaproxy Automation Framework and configure the scope.</p><p><img loading=lazy src=/images/zap_automation_scope.png alt=zap_automation_scope></p><p>After configuring the automation settings, click on the &ldquo;Run&rdquo; button and wait for the process to finish. Once completed, you can find the sitemap of your specified scope at <code>/home/{USER}/reqs.json</code>, where <code>{USER}</code> represents the appropriate user directory on your system.</p><h2 id=using-the-output-with-lotus>Using the Output with Lotus<a hidden class=anchor aria-hidden=true href=#using-the-output-with-lotus>#</a></h2><p>you can use the <code>SCAN_TYPE</code> number 0</p><blockquote><p>Note: this script is not offical, just a simple example to scan url,body parameters in multi-threading</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=c1>-- xss.lua</span>
</span></span><span class=line><span class=cl><span class=n>SCAN_TYPE</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>PAYLOADS</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>&gt;&lt;img src=x onerror=alert()&gt;&#34;</span><span class=p>,</span><span class=s2>&#34;</span><span class=se>\&#34;</span><span class=s2>&gt;&lt;svg/onload=alert()&gt;&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>function</span> <span class=nf>scanner</span><span class=p>(</span><span class=n>param_type</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>local</span> <span class=n>reqs</span> <span class=o>=</span> <span class=n>full_req</span><span class=p>:</span><span class=n>set</span><span class=p>(</span><span class=n>param_type</span><span class=p>,</span> <span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=kr>for</span> <span class=n>_</span><span class=p>,</span> <span class=n>req</span> <span class=kr>in</span> <span class=n>pairs</span><span class=p>(</span><span class=n>reqs</span><span class=p>)</span> <span class=kr>do</span>
</span></span><span class=line><span class=cl>        <span class=kd>local</span> <span class=n>resp</span> <span class=o>=</span> <span class=n>req</span><span class=p>:</span><span class=n>send</span><span class=p>(</span><span class=n>req</span><span class=p>,</span><span class=n>http</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=kd>local</span> <span class=n>body</span> <span class=o>=</span> <span class=n>resp</span><span class=p>[</span><span class=s2>&#34;body&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=kr>if</span> <span class=n>str_contains</span><span class=p>(</span><span class=n>body</span><span class=p>,</span><span class=n>payload</span><span class=p>)</span> <span class=o>==</span> <span class=kc>true</span> <span class=kr>then</span> 
</span></span><span class=line><span class=cl>                <span class=n>Reports</span><span class=p>:</span><span class=n>add</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;Reflected XSS&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>url</span> <span class=o>=</span> <span class=n>resp.url</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>risk</span> <span class=o>=</span> <span class=s2>&#34;mideum&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=kr>end</span>
</span></span><span class=line><span class=cl>    <span class=kr>end</span>
</span></span><span class=line><span class=cl><span class=kr>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>function</span> <span class=nf>main</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>http</span><span class=p>:</span><span class=n>merge_headers</span><span class=p>(</span><span class=kc>true</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>LuaThreader</span><span class=p>:</span><span class=n>iter_scan</span><span class=p>({</span><span class=n>full_req</span><span class=p>:</span><span class=n>body</span><span class=p>(),</span> <span class=n>full_req</span><span class=p>:</span><span class=n>url</span><span class=p>()},</span> <span class=n>PAYLOADS</span><span class=p>,</span> <span class=n>scanner</span><span class=p>,</span> <span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>end</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /home/user/reqs.txt <span class=p>|</span> lotus scan xss.lua
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>knas@Home ~<span class=o>]</span>$ cat reqs.json <span class=p>|</span> ./lotus scan xss.lua
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Number of URLs: <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Number of hosts: <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Number of HTTP MSGS: <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Number of paths: <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>[</span>INFO<span class=o>]</span> Number of custom entries: <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=o>[</span><span class=c1>#] name: &#34;Reflected XSS&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>[</span><span class=c1>#] risk: &#34;mideum&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>[</span><span class=c1>#] url: &#34;http://testphp.vulnweb.com/listproducts.php?cat=1%22%3E%3Cimg+src%3Dx+onerror%3Dalert%28%29%3E&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=o>[</span><span class=c1>#] name: &#34;Reflected XSS&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>[</span><span class=c1>#] risk: &#34;mideum&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>[</span><span class=c1>#] url: &#34;http://testphp.vulnweb.com/listproducts.php?cat=1%22%3E%3Csvg%2Fonload%3Dalert%28%29%3E&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>It&rsquo;s important to note that Lotus can be used with Zaproxy in various scan types, including host scan, passive scan, and URL scan, not limited to just full scans
This flexibility allows you to leverage Lotus&rsquo;s capabilities across different scanning scenarios</p><p>In conclusion, by harnessing the power of Zaproxy&rsquo;s authorized crawling capabilities, scripting, and automation framework, combined with Lotus&rsquo;s custom sitemap JSON format, you can optimize your security testing and automation efforts
Whether it&rsquo;s authenticating, crawling, scoping, or integrating the results with other tools, this comprehensive approach enables you to enhance your security posture effectively</p><p>Remember to experiment, explore, and stay updated with the latest features and developments in both Zaproxy and Lotus to make the most of their combined potential in securing your applications and systems</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://blog.knas.me/blog/gitea_dos/><span class=title>Next »</span><br><span>With a single request, you can kill any Gitea server</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share How to optimize Zaproxy as an authorized crawler for Lotus on twitter" href="https://twitter.com/intent/tweet/?text=How%20to%20optimize%20Zaproxy%20as%20an%20authorized%20crawler%20for%20Lotus&url=https%3a%2f%2fblog.knas.me%2fblog%2flotus_zap_auto%2f&hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How to optimize Zaproxy as an authorized crawler for Lotus on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.knas.me%2fblog%2flotus_zap_auto%2f&title=How%20to%20optimize%20Zaproxy%20as%20an%20authorized%20crawler%20for%20Lotus&summary=How%20to%20optimize%20Zaproxy%20as%20an%20authorized%20crawler%20for%20Lotus&source=https%3a%2f%2fblog.knas.me%2fblog%2flotus_zap_auto%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How to optimize Zaproxy as an authorized crawler for Lotus on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.knas.me%2fblog%2flotus_zap_auto%2f&title=How%20to%20optimize%20Zaproxy%20as%20an%20authorized%20crawler%20for%20Lotus"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How to optimize Zaproxy as an authorized crawler for Lotus on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.knas.me%2fblog%2flotus_zap_auto%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How to optimize Zaproxy as an authorized crawler for Lotus on whatsapp" href="https://api.whatsapp.com/send?text=How%20to%20optimize%20Zaproxy%20as%20an%20authorized%20crawler%20for%20Lotus%20-%20https%3a%2f%2fblog.knas.me%2fblog%2flotus_zap_auto%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How to optimize Zaproxy as an authorized crawler for Lotus on telegram" href="https://telegram.me/share/url?text=How%20to%20optimize%20Zaproxy%20as%20an%20authorized%20crawler%20for%20Lotus&url=https%3a%2f%2fblog.knas.me%2fblog%2flotus_zap_auto%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://blog.knas.me/>Khaled Nassar blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>