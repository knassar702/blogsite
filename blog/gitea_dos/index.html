<!doctype html><html><head><title>With a single request, you can kill any Gitea server - Khaled Nassar</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Khaled Nassar"><link rel="shortcut icon" type=image/x-icon href=https://blog.knas.me/img/favicon.ico><link rel=stylesheet href=https://blog.knas.me/style.min.39acacc5d2051426f655a6b7fbf4786fbd0fd8fffd09322c9b497ef0f7439b3f.css integrity="sha256-OaysxdIFFCb2Vaa3+/R4b70P2P/9CTIsm0l+8PdDmz8="><link rel=stylesheet href=https://blog.knas.me/style-dark.min.0a647fb6c07e04b77b54fa0515d0a683d39ecdb251dba960fe1f966f7ff36fc2.css media="(prefers-color-scheme: dark)" integrity="sha256-CmR/tsB+BLd7VPoFFdCmg9OezbJR26lg/h+Wb3/zb8I="><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.15.1/css/all.css><meta property="og:title" content="With a single request, you can kill any Gitea server"><meta property="og:description" content="Hey :smiley:
in this blog I&rsquo;m going to tell you how I was able to kill/dos any Gitea server I discovered this bug in Gitea version 1.14.2 in 2021
which was fixed in 1.14.3 by the Gitea team Please note that I wasn&rsquo;t targeting Gitea at all, I was doing some bug bounty hunting on a private target That target&rsquo;s staging-dev.target.com has gitea on it
and I thought, &ldquo;Okay, I think there&rsquo;s CVES for that product&rdquo; and yeah I found some but Unfortunately, the POC isn&rsquo;t included in the CVE report (only the PR on github)"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.knas.me/blog/gitea_dos/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-01-25T11:37:10+02:00"><meta property="article:modified_time" content="2023-01-25T11:37:10+02:00"><meta itemprop=name content="With a single request, you can kill any Gitea server"><meta itemprop=description content="Hey :smiley:
in this blog I&rsquo;m going to tell you how I was able to kill/dos any Gitea server I discovered this bug in Gitea version 1.14.2 in 2021
which was fixed in 1.14.3 by the Gitea team Please note that I wasn&rsquo;t targeting Gitea at all, I was doing some bug bounty hunting on a private target That target&rsquo;s staging-dev.target.com has gitea on it
and I thought, &ldquo;Okay, I think there&rsquo;s CVES for that product&rdquo; and yeah I found some but Unfortunately, the POC isn&rsquo;t included in the CVE report (only the PR on github)"><meta itemprop=datePublished content="2023-01-25T11:37:10+02:00"><meta itemprop=dateModified content="2023-01-25T11:37:10+02:00"><meta itemprop=wordCount content="423"><meta itemprop=keywords content="cybersecurity,bugbounty,dos,"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://blog.knas.me/img/https://avatars.githubusercontent.com/u/45688522?v=4"><meta name=twitter:title content="With a single request, you can kill any Gitea server"><meta name=twitter:description content="Hey :smiley:
in this blog I&rsquo;m going to tell you how I was able to kill/dos any Gitea server I discovered this bug in Gitea version 1.14.2 in 2021
which was fixed in 1.14.3 by the Gitea team Please note that I wasn&rsquo;t targeting Gitea at all, I was doing some bug bounty hunting on a private target That target&rsquo;s staging-dev.target.com has gitea on it
and I thought, &ldquo;Okay, I think there&rsquo;s CVES for that product&rdquo; and yeah I found some but Unfortunately, the POC isn&rsquo;t included in the CVE report (only the PR on github)"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><h1>With a single request, you can kill any Gitea server</h1><header><div class=avatar><img class=avatarMask src="https://blog.knas.me/img/https://avatars.githubusercontent.com/u/45688522?v=4" alt>
<a href=https://blog.knas.me><img class=avatar-border src=https://blog.knas.me/img/avatar-border.svg alt></a></div><h2><a class=author href=https://blog.knas.me>Khaled Nassar</a></h2></header><p class=date>January 25, 2023</p><div id=tags><ul><li><a href=https://blog.knas.me/tags/cybersecurity/>cybersecurity</a></li><li><a href=https://blog.knas.me/tags/bugbounty/>bugbounty</a></li><li><a href=https://blog.knas.me/tags/dos/>dos</a></li></ul></div><div id=contentBody><p>Hey :smiley:</p><p>in this blog I&rsquo;m going to tell you how I was able to kill/dos any Gitea server
I discovered this bug in Gitea version 1.14.2 in 2021</p><p>which was fixed in 1.14.3 by the Gitea team<br>Please note that I wasn&rsquo;t targeting Gitea at all, I was doing some bug bounty hunting on a private target
That target&rsquo;s staging-dev.target.com has gitea on it</p><p>and I thought, &ldquo;Okay, I think there&rsquo;s CVES for that product&rdquo;<br>and yeah I found some but Unfortunately, the POC isn&rsquo;t included in the CVE report (only the PR on github)</p><p>so I decided to play around and see if there&rsquo;s any private keys in the repos on this gitea server (I didn&rsquo;t find any)</p><p>and my mind give me an idea, what If I created an account on this server?
I thought I could find out more because maybe there&rsquo;s an option that lets the user make the repositories private for people with an account on Gitea</p><p>After creating my account, I didn&rsquo;t see any difference
so the last option I have is to send emojis to Gitea&rsquo;s issues page for trolling or joking</p><p>Then I opened Zaproxy and sent many of these emojis to the issues body API in one request
Afterwards, I noticed that subdomain response time is going up
I got a 500 error, and boom, the server wasn&rsquo;t responding when I try to visit the gitea issue that I opened</p><p><img src=https://media.tenor.com/oo6YIBG8_xIAAAAd/excited-hockey.gif alt=Yayy></p><p>When I reported this bug to my target&rsquo;s security team,
the response was too fast, saying &ldquo;Sorry, this is not a part of our products. Could you please forward this report to the Gitea security team&rdquo;
But what&rsquo;s good is they provide me with more info to make a good report for the Gitea security team like logs, screenshots of CPU usage, etc.
<img src=https://blog.knas.me/images/gitea_cpu.png alt=cpu></p><p>When someone visits my gitea issue containing the emojis, the CPU usage gets high. That&rsquo;s because there&rsquo;s too much <strong>text formatting/processing</strong> happening in the back-end for the comment
After I reported the bug to Gitea, they asked me some questions about the environment and if I could reproduce it at the last version (it&rsquo;s on try.gitea.io)</p><p>I&rsquo;ve included it in the report</p><ul><li>Gitea version : 1.14.2</li><li>Git version: 2.32.0</li><li>Operating system: Linux</li><li>Database: MySQL</li><li>Can you reproduce the bug at <a href=https://try.gitea.io>https://try.gitea.io</a>: Yes (<a href=https://try.gitea.io/dtestman/test/issues/1>https://try.gitea.io/dtestman/test/issues/1</a>)</li></ul><p>They respond after 2 days with validating the bug and a PR, and my name is on the release page for my next release :smile:</p><p><img src=https://blog.knas.me/images/gitea_mail.png alt=gitea_mail></p><p>here&rsquo;s the release page: <a href=https://blog.gitea.io/2021/06/gitea-1.14.3-is-released/>https://blog.gitea.io/2021/06/gitea-1.14.3-is-released/</a></p><p>and the fix PR: <a href=https://github.com/go-gitea/gitea/pull/16185>https://github.com/go-gitea/gitea/pull/16185</a></p><p>See you</p><p><img src=https://media.tenor.com/b8DvJ53k8soAAAAd/rat-bye.gif alt=bye></p></div><footer><p>&copy; 2019 Khaled Nassar.
Powered by <a href=https://gohugo.io/>Hugo</a>
using the <a href=https://github.com/koirand/pulp/>pulp</a> theme.</p></footer></body></html>